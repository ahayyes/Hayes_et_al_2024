# Analyses and Data for the manuscript 'Antimicrobial effects, and selection for AMR by non-antibiotic drugs on bacterial communities' submitted to Microbiome
DOI of paper XXX

Sequence data is deposited at ENA - Accession Number PRJEB74464 DOI 

All other data is deposited here as part of this repository.

##  Outline 
This repository contains the datasets, analyses, and figures for the paper 'Antimicrobial effects, and selection for AMR by non-antibiotic drugs on bacterial communities'. The code present can recreate all figures and tables. The raw sequencing data for the metagenomics analyses are available at XXX. The code for running the bioinformatics pipelines (ARGs-OAP, Bacmet, MetaPhlAn) are not present here, but all pipelines were run with default parameters. The code for running these are available on request. [ARGs-OAP](https://github.com/xinehc/ARGs_OAP) version 2.0 was used to identify ARGs present (both at antibiotic class and individual gene level) in all samples. In these analyses, ARG hits normalised to 16S rRNA counts (as generated by the ARGs-OAP pipeline) were used. [BacMet](http://bacmet.biomedicine.gu.se/) was used to determine metal and biocide resistance genes present in the samples. The BacMet outputs were normalised to the 16S reads generated in ARGs-OAP and hits were filtered to match the default parameters of ARGs-OAP (i.e. 80% identity match of at least 25bp). [MetaPhlAn 2.0](https://github.com/biobakery/MetaPhlAn/wiki/MetaPhlAn2) was used to identify the taxonomy of the samples, FLASH2 was used to pair the forward and reverse reads, and these paired reads were used in the MetaPhlAn pipeline. 

This repository contains the qPCR and plating datasets, all code for the analyses (including for sequence data) and figures of the above-mentioned paper. 

## Information about the files 

**Growth Data**

There are three dataframes of growth data (i.e. Diclofenac_growth). These dataframes contain the matrix read out from the plate reader. I.e. they contain a first column of well (labelled with treatment and replicate) and subsequent columns of time points and OD read at that time point.

**Plating Data** 

Full results of the plating experiment. Community was exposed to diclofenac, metformin, and 17-beta-estradiol at 20uM for seven days, and at the end of the seven day experiment plated onto coliform selective agar containing one of six (or no antibioitc) antibioitcs. The data is split by E. coli and presumptive coliforms since these can be identified as they grow either purple or pink on coliform selective agar. The antibioitcs used were ampicillin (amp), azithromyicn (azi), cefotaxime (cef), ciprofloxacin (cip), gentamicin (gen), and tetracycline (tet). Each treatment is recorded as NAD_biological replicate technical replicate (i.e. D_1 R1 means this is diclofenac biological replicate 1, technical replicate 1). The columns of the dataset indicate the dilution plated. 

**qPCR Data**

There are three sets of qPCR results (i.e. Diclofenac_qPCR etc.). These results hold the day 0 (d0) and day 7 (d7) qPCR quantities for the four genes targeted - 16S _rRNA_, _intI1_, _cintI1_, and _sul1_

**Note on the sequencing data**

The diclofenac and 17-β-estradiol experiments were sequenced using NEB Ultra ll FS library prep, and the metformin experiment used a PCR free library prep. There is a set of inoculum sequenced using both library preps to account for any biases when comparing to the inoculum. The inoculum to be used with the diclofenac and 17-β-estradiol analyses are 'inoculum_r1_trimmed_r1, inoculum_r1_trimmed_r2' etc. The inoculum files to be used metformin anlayses are 'inocR1_R1_001, inocR1_R2_001' etc. The right inoculum pipeline output files are often contained in the NAD folder they should be used with. There is a '16S Data.txt' file for diclofenac, metformin, and 17-beta-estradiol that was generated during the first step of the ARGs-OAP pipeline. This is used to normalise the BacMet data. 

**ARG Data**

The outputs from [ARGs-OAP](https://github.com/xinehc/ARGs_OAP) are deposited here as text files, with outputs of antibiotic class abundnaces, and individual gene abundances in nested folders for each NAD. 
There are also three datasets of transposed dataframes (i.e. Diclofenac_ARG Transposed Dataframe). These data contain the transposed dataframes that need to be read into R to be able to do NMDS plots. These dataframes were created by reading the dataframe created from the ARG analysis scripts (e.g. XXX), and transposing them in Excel. 

**BMRG Data**

The outputs from [BacMet](http://bacmet.biomedicine.gu.se/) are deposited here as text files. Again, there are three datasets of transposed BMRG datasets to be read into R to make the NMDS. These dataframes were created by reading the dataframe created in R from the BMRG analysis scripts, and then transposing them into Excel.

**Taxonomy Data**

The outputs from [MetaPhlAn 2.0](https://github.com/biobakery/MetaPhlAn/wiki/MetaPhlAn2) are deposited here as text files. 
